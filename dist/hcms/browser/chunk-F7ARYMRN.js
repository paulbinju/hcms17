import{a as F,b as N,l as H}from"./chunk-366PFCO3.js";import{$ as T,Da as w,Ea as k,Ga as I,Ia as A,U as s,V as S,W as j,X as g,aa as E,ma as L}from"./chunk-5OTRJNO2.js";import{h as u}from"./chunk-RZFRLYII.js";var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0;function K(t,r){return typeof r>"u"?r={autoBom:!1}:typeof r!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),r={autoBom:!r}),r.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\uFEFF",t],{type:t.type}):t}function C(t,r,e){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){v(o.response,r,e)},o.onerror=function(){console.error("could not download file")},o.send()}function J(t){var r=new XMLHttpRequest;r.open("HEAD",t,!1);try{r.send()}catch{}return r.status>=200&&r.status<=299}function m(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(r)}}var W=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),v=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!W?function(r,e,o){var n=l.URL||l.webkitURL,i=document.createElement("a");e=e||r.name||"download",i.download=e,i.rel="noopener",typeof r=="string"?(i.href=r,i.origin!==location.origin?J(i.href)?C(r,e,o):m(i,i.target="_blank"):m(i)):(i.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){m(i)},0))}:"msSaveOrOpenBlob"in navigator?function(r,e,o){if(e=e||r.name||"download",typeof r=="string")if(J(r))C(r,e,o);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){m(n)})}else navigator.msSaveOrOpenBlob(K(r,o),e)}:function(r,e,o,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return C(r,e,o);var i=r.type==="application/octet-stream",c=/constructor/i.test(l.HTMLElement)||l.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||i&&c||W)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var p=y.result;p=d?p:p.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=p:location=p,n=null},y.readAsDataURL(r)}else{var D=l.URL||l.webkitURL,M=D.createObjectURL(r);n?n.location=M:location.href=M,n=null,setTimeout(function(){D.revokeObjectURL(M)},4e4)}});l.saveAs=v.saveAs=v;var U=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=T({type:t}),t.\u0275inj=S({imports:[F]}),t})(),a=function(t){return t.XLS="xls",t.XLSX="xlsx",t.CSV="csv",t.TXT="txt",t.JSON="json",t.OTHER="other",t}(a||{}),f=class{constructor(r,e){this.extension=r,this.contentTypeHeader=e}},Z="mat-table-exporter",ee="array",te=";charset=utf-",x=te+"8",O=a.TXT+"/",re="application/",z=re+"octet-stream",h=".",oe=",",ne=h+a.XLS,ie=h+a.XLSX,ae=h+a.CSV,se=h+a.JSON,ce=h+a.TXT,le=new f(ne,z+x),de=new f(ie,z+x),ue=new f(se,O+JSON+x),ge=new f(ce,O+a.TXT+x),fe=new f(ae,O+a.CSV+x);var he=h+"*."+a.XLS+"$",pe=`
`,ve="	",xe="!cols",Se="\uFEFF",X=new j("XLSX_LIGHTWEIGHT"),R=class t{static save(r,e,o){let n=new Blob([r],{type:e.contentTypeHeader}),i=Z;o&&o.fileName&&(i=o.fileName),v(n,i+e.extension)}static isXls(r){return r.toLowerCase().match(he)!=null}static identifyExportType(r){return r&&t.isXls(r)?a.XLS:a.XLSX}static removeExtension(r){r&&(r.fileName=r.fileName?.split(h)[0])}},P=(()=>{class t{constructor(){}export(e,o){if(!e)throw new Error("Empty json array is provided, rows parameter is mandatory!");let n=this.getMimeType();this.createContent(e,o).then(i=>{R.save(i,n,o)})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),_=(()=>{class t{constructor(e){this.xlsxLightweight=e}getXlsx(){return u(this,null,function*(){return this.xlsxLightweight?yield import("./chunk-5GCFYDJM.js"):yield import("./chunk-H7OA2UTT.js")})}}return t.\u0275fac=function(e){return new(e||t)(g(X,8))},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),B=(()=>{class t extends P{constructor(e){super(),this.sheetJsHelper=e}createContent(e,o){return u(this,null,function*(){let n=(yield this.sheetJsHelper.getXlsx()).utils.json_to_sheet(e,{skipHeader:!0});return yield this.workSheetToContent(n,o)})}}return t.\u0275fac=function(e){return new(e||t)(g(_))},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Te=(()=>{class t extends B{constructor(e){super(e)}workSheetToContent(e,o){return u(this,null,function*(){let n=(yield this.sheetJsHelper.getXlsx()).utils.sheet_to_csv(e,{FS:o?.delimiter??oe});return Se+n})}getMimeType(){return fe}}return t.\u0275fac=function(e){return new(e||t)(g(_))},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Ee=(()=>{class t extends P{constructor(){super()}createContent(e,o){return u(this,null,function*(){let n="";return e.forEach(i=>{n+=Object.values(i).join(this.getDelimiter(o))+pe}),n})}getMimeType(){return ge}getDelimiter(e){return e&&e.delimiter?e.delimiter:ve}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),V=(()=>{class t extends B{constructor(e){super(e)}workSheetToContent(n){return u(this,arguments,function*(e,o={}){let{utils:i,write:c}=yield this.sheetJsHelper.getXlsx(),d=i.book_new();return o.columnWidths&&(e[xe]=this.convertToWch(o.columnWidths)),this.correctTypes(o),i.book_append_sheet(d,e,o.sheet),c(d,o)})}getMimeType(){return le}correctTypes(e){e.type||(e.type=ee),e.bookType=this.getMimeType().extension.replace(".","")}convertToWch(e){return e.map(o=>({wch:o}))}}return t.\u0275fac=function(e){return new(e||t)(g(_))},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),we=(()=>{class t extends P{constructor(){super()}createContent(e,o){return u(this,null,function*(){return JSON.stringify(e)})}getMimeType(){return ue}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),b=(()=>{class t extends V{constructor(e){super(e)}getMimeType(){return de}}return t.\u0275fac=function(e){return new(e||t)(g(_))},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),G=(()=>{class t{constructor(e){this.injector=e}getService(e,o){switch(e){case a.XLS.valueOf():return this.injector.get(V);case a.XLSX.valueOf():return this.injector.get(b);case a.JSON.valueOf():return this.injector.get(we);case a.TXT.valueOf():return this.injector.get(Ee);case a.CSV.valueOf():return this.injector.get(Te);case a.OTHER.valueOf():return o||(console.error("Provide a custom exporter implementation. Using default exporter."),this.injector.get(b));default:return this.injector.get(b)}}}return t.\u0275fac=function(e){return new(e||t)(g(L))},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Y=(()=>{class t{constructor(){}extractRows(e,o,n){return this.getRowsAsJsonArray(e,n??e._rowOutlet,o)}getRowsAsJsonArray(e,o,n){let i=this.getRenderedRows(e,o);return this.convertToJsonArray(i,n)}getRenderedRows(e,o){return e._getRenderedRows(o)}convertToJsonArray(e,o){let n=new Array;for(let i=0;i<e.length;i++){let c=this.convertRow(e[i],o);n.push(this.createExcelItem(c))}return n}convertRow(e,o){let n=new Array,i=e.children;for(let c=0;c<i.length;c++)if(!this.shouldHide(c,o)){let d=i.item(c).innerText.trim();n.push(d)}return n}shouldHide(e,o){return!!(o&&o.includes(e))}createExcelItem(e){return Object.assign({},e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),q=(()=>{class t{constructor(e,o,n){this.serviceLocator=e,this.dataExtractor=o,this._cdkTable=n,this.exportCompleted=new I,this.exportStarted=new I}exportTable(e,o){this.loadExporter(e),this._options=o,this.exportStarted.emit(),this._isIterating=!0,this._isExporting=!0,this._data=new Array,this.extractTableHeader();try{this.exportWithPagination()}catch{this.exportSinglePage()}}toggleRow(e){let o=this.getPaginatedRowIndex(e);this.isToggleOn(o)?this.toggleOff(o):this.toggleOn(o)}resetToggleRows(){this._selectedRows=[]}toggleOn(e){this._selectedRows=[...this._selectedRows||[],e]}toggleOff(e){this._selectedRows=this._selectedRows.filter(o=>o!==e)}isToggleOn(e){return this._selectedRows?.includes(e)}loadExporter(e){this._exporterService=this.serviceLocator.getService(e,this.exporter)}exportWithPagination(){this._initialPageIndex=this.getCurrentPageIndex(),this.initPageHandler(),this.goToPage(0)}exportSinglePage(){this.extractDataOnCurrentPage(),this.extractTableFooter(),this.exportExtractedData()}extractDataOnCurrentPage(){let e=this.dataExtractor.extractRows(this._cdkTable,this.hiddenColumns);this._data=this._data.concat(this.getSelectedRows(e))}getSelectedRows(e){return this.isSelectiveExport()?e.filter((o,n)=>this._selectedRows.includes(this.getPaginatedRowIndex(n))):e}isSelectiveExport(){return this._selectedRows&&!this.isMasterToggleOff()&&!this.isMasterToggleOn()}isMasterToggleOn(){return this.compareSelectedRowCount(this.getTotalItemsCount())}isMasterToggleOff(){return this.compareSelectedRowCount(0)}compareSelectedRowCount(e){return this._selectedRows.length===e}initPageHandler(){this._subscription||(this._subscription=this.getPageChangeObservable()?.subscribe(()=>{setTimeout(()=>{this._isIterating?(this.extractDataOnCurrentPage(),this.hasNextPage()?this.nextPage():(this._isIterating=!1,this.goToPage(this._initialPageIndex))):this._isExporting&&(this._isExporting=!1,this.extractTableFooter(),this.exportExtractedData())})}))}exportExtractedData(){this._exporterService.export(this._data,this._options),this._data=new Array,this.exportCompleted.emit()}extractSpecialRows(e){this._data.push(...this.dataExtractor.extractRows(this._cdkTable,this.hiddenColumns,e))}extractTableHeader(){this.extractSpecialRows(this._cdkTable._headerRowOutlet)}extractTableFooter(){this.extractSpecialRows(this._cdkTable._footerRowOutlet)}hasNextPage(){return this.getCurrentPageIndex()<this.getPageCount()-1}nextPage(){this.goToPage(this.getCurrentPageIndex()+1)}getPaginatedRowIndex(e){return e+this.getPageSize()*this.getCurrentPageIndex()}}return t.\u0275fac=function(e){k()},t.\u0275dir=E({type:t,inputs:{hiddenColumns:"hiddenColumns",exporter:"exporter"},outputs:{exportCompleted:"exportCompleted",exportStarted:"exportStarted"}}),t})();var ke=(()=>{class t extends q{ngAfterViewInit(){this.exportStarted.subscribe(e=>{this.enablePaginator(!1)}),this.exportCompleted.subscribe(e=>{this.enablePaginator(!0)})}constructor(e,o,n){super(e,o,n)}getPageCount(){if(this.getPageSize()==0)return 0;let o=this.getTotalItemsCount()/this.getPageSize();return Math.ceil(o)??1}getPageSize(){return this.getPaginator()?.pageSize??0}getCurrentPageIndex(){return this.getPaginator()?.pageIndex??0}getTotalItemsCount(){return this.getPaginator()?.length??this.getDataSource()?.data?.length??0}goToPage(e){let o=this.getPaginator();o.pageIndex=e,o._changePageSize(o.pageSize)}getPageChangeObservable(){return this.getPaginator()?.page}getDataSource(){return this._cdkTable.dataSource}getPaginator(){return this.getDataSource()?.paginator}enablePaginator(e){let o=this.getPaginator();o.disabled=!e,o._changePageSize(o.pageSize)}}return t.\u0275fac=function(e){return new(e||t)(w(G),w(Y),w(N,11))},t.\u0275dir=E({type:t,selectors:[["","matTableExporter",""]],exportAs:["matTableExporter"],features:[A]}),t})(),Ae=(()=>{class t{static forRoot(e){return{ngModule:t,providers:[{provide:X,useValue:e.xlsxLightWeight}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=T({type:t}),t.\u0275inj=S({imports:[H,U]}),t})();export{ke as a,Ae as b};
